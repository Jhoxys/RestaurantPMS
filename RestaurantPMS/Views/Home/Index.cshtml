@using Microsoft.AspNetCore.Html

@model DashboardDto

@{
    ViewData["Title"] = "Dashboard";
}

<!-- Resumen de métricas -->
<div class="row g-3 mb-4">
    <div class="col-md-2">
        <div class="card-summary bg-azul">
            <h6>Pedidos Hoy</h6>
            <h2>@Model.OrdersToday</h2>
        </div>
    </div>
    <div class="col-md-2">
        <div class="card-summary bg-amarillo">
            <h6>Pendientes</h6>
            <h2>@Model.PendingOrders</h2>
        </div>
    </div>
    <div class="col-md-2">
        <div class="card-summary bg-verde">
            <h6>Mesas Ocupadas</h6>
            <h2>@Model.OccupiedTables</h2>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card-summary bg-morado">
            <h6>Ingresos Hoy</h6>
            <h2>@Model.IncomeToday.ToString("C")</h2>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card-summary bg-rojo">
            <h6>Stock Bajo</h6>
            <h2>@Model.LowStock</h2>
        </div>
    </div>
</div>

<div class="row g-4">
    <!-- Pedidos Recientes -->
    <div class="col-md-6">
        <div class="card shadow-sm">
            <div class="card-header fw-bold">Pedidos Recientes</div>
            <div class="card-body">
                @foreach (var order in Model.Orders.OrderByDescending(o => o.CreatAt).Take(5))
                {
                    <div class="mb-3 border-bottom pb-2">
                        <h6>
                            Mesa @order.TableId
                            <span class="status status-@order.State.ToLower()">@order.State</span>
                        </h6>
                        <p class="mb-0">
                            @order.OrderProducts.Sum(op => op.Product.UnidPrice * op.Quantity).ToString("C")
                            • @order.ClientId
                        </p>
                    </div>
                }
            </div>
        </div>
    </div>

    <!-- Estado de Mesas -->
    <div class="col-md-6">
        <div class="card shadow-sm">
            <div class="card-header fw-bold">Estado de Mesas</div>
            <div class="card-body d-flex flex-wrap justify-content-center">
                @foreach (var table in Model.Tables)
                {
                    if (table.IsOccupied)
                    {
                        <div class="mesa ocupada">@table.Number<br><small>Ocupada</small></div>
                    }
                    else
                    {
                        <div class="mesa disponible">@table.Number<br><small>Disponible</small></div>
                    }
                }
            </div>
        </div>
    </div>
</div>